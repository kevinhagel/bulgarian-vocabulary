---
phase: 05-frontend-foundation-vocabulary-ui
plan: 04
type: execute
wave: 3
depends_on: ["05-02", "05-03"]
files_modified:
  - frontend/src/features/vocabulary/components/VocabularyDetail.tsx
  - frontend/src/features/vocabulary/components/InflectionsTable.tsx
  - frontend/src/App.tsx
autonomous: false

must_haves:
  truths:
    - "User can view lemma details including all inflections with grammatical info"
    - "User can play audio for the lemma in the detail view"
    - "User can play audio for each individual inflection"
    - "Detail view is mobile-responsive"
    - "User can navigate back to vocabulary list from detail view"
  artifacts:
    - path: "frontend/src/features/vocabulary/components/VocabularyDetail.tsx"
      provides: "Vocabulary detail page with full lemma information"
      contains: "useVocabularyDetail"
    - path: "frontend/src/features/vocabulary/components/InflectionsTable.tsx"
      provides: "Table/list of inflections with audio playback"
      contains: "AudioPlayButton"
  key_links:
    - from: "frontend/src/features/vocabulary/components/VocabularyDetail.tsx"
      to: "/api/vocabulary/{id}"
      via: "useVocabularyDetail hook"
      pattern: "useVocabularyDetail"
    - from: "frontend/src/features/vocabulary/components/InflectionsTable.tsx"
      to: "frontend/src/components/audio/AudioPlayButton.tsx"
      via: "AudioPlayButton per inflection"
      pattern: "AudioPlayButton"
---

<objective>
Build the vocabulary detail page showing full lemma information with inflections table and audio playback for both lemma and all inflections. Verify the complete frontend application.

Purpose: Delivers the detail view (success criteria 10) with audio for inflections (AUDIO-05) and completes the full vocabulary management UI. The checkpoint verifies all 11 success criteria are met.
Output: Vocabulary detail page with inflections table, per-inflection audio playback, and verified working frontend application.
</objective>

<execution_context>
@/Users/kevin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kevin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-frontend-foundation-vocabulary-ui/05-RESEARCH.md
@.planning/phases/05-frontend-foundation-vocabulary-ui/05-01-SUMMARY.md
@.planning/phases/05-frontend-foundation-vocabulary-ui/05-02-SUMMARY.md
@.planning/phases/05-frontend-foundation-vocabulary-ui/05-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: VocabularyDetail page with inflections table and audio playback</name>
  <files>
    frontend/src/features/vocabulary/components/VocabularyDetail.tsx
    frontend/src/features/vocabulary/components/InflectionsTable.tsx
    frontend/src/App.tsx
  </files>
  <action>
    **1. Create InflectionsTable component** (`frontend/src/features/vocabulary/components/InflectionsTable.tsx`):
    - Props: `inflections: InflectionDTO[]`
    - Responsive table/list showing all inflections for a lemma
    - Columns: Inflected Form (with `lang="bg"` and large font), Grammatical Info, Audio
    - Each row has an AudioPlayButton that plays the inflection's form text
    - Mobile layout: stack columns vertically in card-like rows instead of table
    - Desktop layout: proper table with header row
    - Empty state: "No inflections available" message
    - Tailwind styling: striped rows (`even:bg-gray-50`), proper padding, responsive

    **2. Create VocabularyDetail page** (`frontend/src/features/vocabulary/components/VocabularyDetail.tsx`):
    - Props: `lemmaId: number`, `onBack: () => void`
    - Uses `useVocabularyDetail(lemmaId)` to fetch full lemma data
    - Loading state: spinner
    - Error state: error message with retry
    - Layout sections:
      - **Back button**: "Back to Vocabulary" with left arrow, calls onBack
      - **Header section**:
        - Lemma text in very large Bulgarian font: `<h1 className="text-4xl font-bold" lang="bg">{lemma.text}</h1>`
        - AudioPlayButton next to the lemma text (plays lemma pronunciation)
        - English translation: `<p className="text-xl text-gray-600">{lemma.translation}</p>`
      - **Metadata section**:
        - Part of speech badge (colored pill)
        - Category (if available)
        - Difficulty level badge
        - Source badge (User Entered / System Seed)
        - Review status with colored indicator
        - Created/Updated dates formatted as readable strings
      - **Notes section** (if notes exist):
        - Notes content in a subtle box
      - **Inflections section**:
        - Section header: "Inflections ({count})"
        - InflectionsTable component
      - **Action buttons**:
        - "Edit" button (opens edit modal via Zustand store)
        - "Delete" button (opens delete confirm via Zustand store)
    - Mobile-responsive: all sections stack vertically

    **3. Wire up navigation in App.tsx:**
    - Simple state-based navigation (no router needed for now -- we have only 2 views):
      - State: `selectedLemmaId: number | null`
      - If `selectedLemmaId` is null: show VocabularyList
      - If `selectedLemmaId` is set: show VocabularyDetail with that ID
    - Pass `onViewDetail` callback to VocabularyList: sets selectedLemmaId
    - Pass `onBack` callback to VocabularyDetail: sets selectedLemmaId to null
    - Include CreateVocabularyModal, EditVocabularyModal, and DeleteConfirmDialog in the component tree (these are always rendered, visibility controlled by Zustand)
    - When delete succeeds and the deleted lemma is currently viewed in detail, navigate back to list (listen for deletingLemmaId matching selectedLemmaId)
  </action>
  <verify>
    cd /Users/kevin/projects/bulgarian-vocabulary/frontend && npx tsc --noEmit 2>&1 | tail -10
    # No type errors

    cd /Users/kevin/projects/bulgarian-vocabulary/frontend && npm run build 2>&1 | tail -5
    # Build succeeds
  </verify>
  <done>
    VocabularyDetail page renders full lemma info with large Bulgarian text, translation, metadata badges, notes, and inflections table. AudioPlayButton next to lemma text and each inflection enables pronunciation playback. Navigation works: clicking "View" in vocabulary list shows detail, "Back" returns to list. Edit and delete actions available from detail view. Mobile-responsive layout.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify complete frontend application</name>
  <files>
    frontend/src/App.tsx
  </files>
  <action>
    This is a human verification checkpoint. Claude does not make code changes in this task.

    **What was built:**
    Complete React 19 frontend for Bulgarian Vocabulary Tutor with:
    - Vocabulary list page with card grid, search, filters, pagination
    - Create vocabulary modal with form validation and LLM processing
    - Edit vocabulary modal with pre-populated form and inflection editing
    - Delete vocabulary with confirmation dialog
    - Vocabulary detail page with inflections table
    - Audio playback for lemmas and inflections
    - Mobile-responsive design with Bulgarian Cyrillic fonts

    **How to verify:**

    Prerequisites:
    1. Ensure SSH tunnel to Mac Studio is running: `./scripts/tunnel-to-mac-studio.sh`
    2. Start Spring Boot backend (IntelliJ or `cd backend && mvn spring-boot:run`)
    3. Start frontend: `cd frontend && npm run dev`
    4. Open http://localhost:5173 in browser

    Verify each success criterion:
    1. React app runs with HMR -- page loads without errors in browser console
    2. TanStack Query -- open React Query Devtools (floating button in bottom corner), verify queries appear
    3. Zustand -- filter interactions update immediately without page reload
    4. Vocabulary list with Cyrillic -- verify Bulgarian text (from seed data) renders in Sofia Sans font, text is large and clear
    5. Add vocabulary -- click "Add Vocabulary", enter a Bulgarian word (e.g., "пиша"), translation (e.g., "to write"), submit. Verify LLM processing indicator appears, entry appears in list after completion
    6. Edit vocabulary -- click "Edit" on an entry, modify translation, save. Verify change appears in list
    7. Delete vocabulary -- click "Delete" on an entry, confirm. Verify entry disappears from list
    8. Search/filter -- type "к" in search box, verify results filter. Try dropdown filters for part of speech
    9. Audio for lemma -- click play button on any vocabulary card. Verify Bulgarian pronunciation plays
    10. Detail view with inflection audio -- click "View" on a verb entry, verify inflections table shows. Click play on individual inflections
    11. Mobile responsive -- resize browser to narrow width (or use DevTools mobile view). Verify layout stacks to single column

    Known limitations to accept:
    - First audio play may take 1-2 seconds (TTS generation)
    - LLM create may take 1-3 seconds (Ollama processing)
    - inflectionCount shows 0 in list view (lazy loading trade-off from Phase 4)

    Resume signal: Type "approved" if all criteria pass, or describe issues found.
  </action>
  <verify>
    Human verifies all 11 success criteria by interacting with the running application.
  </verify>
  <done>
    All 11 Phase 5 success criteria verified by human testing. Application is functional, responsive, and properly renders Bulgarian Cyrillic text with audio playback.
  </done>
</task>

</tasks>

<verification>
1. All 11 Phase 5 success criteria verified by human
2. Frontend builds and runs without errors
3. Backend API integration works through Vite proxy
4. Audio playback works for both lemmas and inflections
5. CRUD operations work end-to-end
6. Mobile-responsive layout confirmed
</verification>

<success_criteria>
- Complete vocabulary management UI is functional and verified
- All 11 Phase 5 success criteria pass human verification
- Audio playback works for lemmas (AUDIO-04) and inflections (AUDIO-05)
- Application is mobile-responsive
</success_criteria>

<output>
After completion, create `.planning/phases/05-frontend-foundation-vocabulary-ui/05-04-SUMMARY.md`
</output>
