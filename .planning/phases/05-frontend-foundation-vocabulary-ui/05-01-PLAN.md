---
phase: 05-frontend-foundation-vocabulary-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/vite.config.ts
  - frontend/tsconfig.json
  - frontend/tsconfig.app.json
  - frontend/tsconfig.node.json
  - frontend/index.html
  - frontend/src/main.tsx
  - frontend/src/App.tsx
  - frontend/src/index.css
  - frontend/src/vite-env.d.ts
  - frontend/src/lib/queryClient.ts
  - frontend/src/lib/api.ts
  - frontend/src/features/vocabulary/types.ts
  - frontend/src/components/layout/Header.tsx
  - frontend/src/components/layout/Layout.tsx
  - frontend/src/components/audio/AudioPlayer.tsx
  - frontend/.gitignore
  - frontend/.env
  - backend/src/main/java/com/vocab/bulgarian/audio/controller/AudioController.java
autonomous: true

must_haves:
  truths:
    - "React 19 + Vite 6 + TypeScript application starts with `npm run dev` and hot-reloads"
    - "Tailwind CSS utility classes render correctly with Bulgarian Cyrillic font (Sofia Sans)"
    - "TanStack Query provider wraps the app and devtools are accessible"
    - "Vite dev server proxies /api requests to Spring Boot backend on localhost:8080"
    - "Backend has POST /api/audio/generate endpoint that accepts text and returns filename"
  artifacts:
    - path: "frontend/package.json"
      provides: "Project dependencies and scripts"
      contains: "react"
    - path: "frontend/vite.config.ts"
      provides: "Vite configuration with proxy and path aliases"
      contains: "proxy"
    - path: "frontend/src/main.tsx"
      provides: "React entry point with QueryClientProvider"
      contains: "QueryClientProvider"
    - path: "frontend/src/features/vocabulary/types.ts"
      provides: "TypeScript types mirroring backend DTOs"
      contains: "LemmaResponseDTO"
    - path: "frontend/src/components/audio/AudioPlayer.tsx"
      provides: "Reusable audio playback component"
      contains: "audioRef"
    - path: "backend/src/main/java/com/vocab/bulgarian/audio/controller/AudioController.java"
      provides: "Audio generation REST endpoint"
      contains: "generateAudio"
  key_links:
    - from: "frontend/src/lib/api.ts"
      to: "/api"
      via: "axios baseURL"
      pattern: "baseURL.*api"
    - from: "frontend/vite.config.ts"
      to: "http://localhost:8080"
      via: "Vite proxy configuration"
      pattern: "proxy.*8080"
    - from: "frontend/src/main.tsx"
      to: "frontend/src/lib/queryClient.ts"
      via: "QueryClientProvider import"
      pattern: "QueryClientProvider"
---

<objective>
Scaffold the complete React 19 + Vite 6 + TypeScript frontend project with all dependencies, configurations, and shared infrastructure components. Add backend audio generation endpoint needed for frontend audio playback.

Purpose: Establish the frontend foundation that all subsequent plans depend on -- build tooling, state management setup, API client, TypeScript types, layout components, and audio playback component.
Output: Working React dev server with hot-reload, configured API proxy to Spring Boot, TypeScript types matching backend DTOs, layout shell, and reusable AudioPlayer component.
</objective>

<execution_context>
@/Users/kevin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kevin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-frontend-foundation-vocabulary-ui/05-RESEARCH.md
@.planning/phases/04-core-vocabulary-management/04-02-SUMMARY.md
@.planning/phases/03-tts-audio-generation/03-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Vite + React 19 + TypeScript project with all dependencies and configurations</name>
  <files>
    frontend/package.json
    frontend/vite.config.ts
    frontend/tsconfig.json
    frontend/tsconfig.app.json
    frontend/tsconfig.node.json
    frontend/index.html
    frontend/src/index.css
    frontend/src/vite-env.d.ts
    frontend/.gitignore
    frontend/.env
  </files>
  <action>
    Create the frontend/ directory at project root and scaffold a Vite + React + TypeScript project.

    1. **Create project with Vite:**
       ```bash
       cd /Users/kevin/projects/bulgarian-vocabulary
       npm create vite@latest frontend -- --template react-ts
       ```

    2. **Install production dependencies:**
       ```bash
       cd frontend
       npm install @tanstack/react-query zustand react-hook-form zod @hookform/resolvers axios
       ```

    3. **Install dev dependencies:**
       ```bash
       npm install -D @tanstack/react-query-devtools tailwindcss @tailwindcss/vite
       ```

    4. **Configure vite.config.ts:**
       - Import `react` plugin from `@vitejs/plugin-react`
       - Import `tailwindcss` from `@tailwindcss/vite`
       - Add both plugins: `plugins: [react(), tailwindcss()]`
       - Configure path alias: `resolve.alias: { '@': path.resolve(__dirname, './src') }`
       - Configure dev server port: `server.port: 5173`
       - Configure API proxy: `server.proxy: { '/api': { target: 'http://localhost:8080', changeOrigin: true } }`

    5. **Configure tsconfig.json and tsconfig.app.json:**
       - Add to compilerOptions: `"baseUrl": ".", "paths": { "@/*": ["./src/*"] }`

    6. **Configure index.html:**
       - Set `<html lang="bg">` for Bulgarian Cyrillic rendering
       - Set page title to "Bulgarian Vocabulary Tutor"
       - Add Google Fonts link for Sofia Sans: `<link href="https://fonts.googleapis.com/css2?family=Sofia+Sans:wght@400;600;700&display=swap" rel="stylesheet">`

    7. **Configure src/index.css with Tailwind CSS 4:**
       ```css
       @import "tailwindcss";

       @theme {
         --color-primary: #3b82f6;
         --color-primary-dark: #2563eb;
         --color-danger: #ef4444;
         --color-success: #22c55e;
         --color-warning: #f59e0b;
         --font-family-sans: 'Sofia Sans', 'Segoe UI', system-ui, sans-serif;
       }

       body {
         @apply bg-gray-50 text-gray-900 antialiased;
       }
       ```

    8. **Create frontend/.gitignore:**
       - node_modules, dist, .env, .env.local, *.log

    9. **Create frontend/.env:**
       ```
       VITE_API_BASE_URL=/api
       ```

    10. **Clean up Vite template defaults:**
        - Remove `src/App.css` (using Tailwind instead)
        - Remove `src/assets/react.svg` and `public/vite.svg` (not needed)
        - Keep `src/vite-env.d.ts` as-is (Vite type definitions)

    **Verify:** Run `cd frontend && npm run dev` -- app should start on http://localhost:5173 with hot-reload working. Kill the dev server after verification.
  </action>
  <verify>
    cd /Users/kevin/projects/bulgarian-vocabulary/frontend && npm run build 2>&1 | tail -5
    # Build should succeed with no errors
  </verify>
  <done>
    Vite + React 19 + TypeScript project builds successfully with all dependencies installed (TanStack Query, Zustand, React Hook Form, Zod, Tailwind CSS 4, Axios). Vite config has API proxy to localhost:8080 and @ path alias. index.html has lang="bg" and Sofia Sans font. Tailwind CSS renders with custom theme tokens.
  </done>
</task>

<task type="auto">
  <name>Task 2: Backend audio endpoint, TypeScript types, API client, providers, layout shell, and AudioPlayer</name>
  <files>
    backend/src/main/java/com/vocab/bulgarian/audio/controller/AudioController.java
    frontend/src/lib/queryClient.ts
    frontend/src/lib/api.ts
    frontend/src/features/vocabulary/types.ts
    frontend/src/components/layout/Header.tsx
    frontend/src/components/layout/Layout.tsx
    frontend/src/components/audio/AudioPlayer.tsx
    frontend/src/main.tsx
    frontend/src/App.tsx
  </files>
  <action>
    **Part A: Backend audio generation endpoint**

    Add a POST endpoint to the existing AudioController for triggering audio generation from the frontend. This is required because the backend currently only serves existing audio files (GET /api/audio/{filename}) but has no endpoint to trigger generation.

    Add to `backend/src/main/java/com/vocab/bulgarian/audio/controller/AudioController.java`:
    - Import AudioGenerationService
    - Inject AudioGenerationService via constructor (add to existing constructor)
    - Add POST /api/audio/generate endpoint:
      - Accepts `@RequestBody Map<String, String>` with key "text" (Bulgarian text to generate audio for)
      - Validates text is not null/blank
      - Calls `audioGenerationService.generateAudioAsync(text)` for async generation
      - Returns `CompletableFuture<ResponseEntity<Map<String, String>>>` with key "filename" containing the generated filename
      - Returns 400 Bad Request if text is blank
    - The URL pattern for audio playback is: `/api/audio/{filename}` where filename is the returned hash.mp3

    **Part B: TypeScript types mirroring backend DTOs**

    Create `frontend/src/features/vocabulary/types.ts`:
    - Enum types as string union types: `Source = 'USER_ENTERED' | 'SYSTEM_SEED'`, `PartOfSpeech` (11 values: NOUN, VERB, ADJECTIVE, ADVERB, PRONOUN, PREPOSITION, CONJUNCTION, NUMERAL, INTERJECTION, PARTICLE, INTERROGATIVE), `DifficultyLevel = 'BEGINNER' | 'INTERMEDIATE' | 'ADVANCED'`, `ReviewStatus = 'PENDING' | 'REVIEWED' | 'NEEDS_CORRECTION'`
    - `InflectionDTO`: `{ id: number; form: string; grammaticalInfo: string | null }`
    - `LemmaResponseDTO`: `{ id: number; text: string; translation: string; partOfSpeech: PartOfSpeech | null; category: string | null; difficultyLevel: DifficultyLevel | null; source: Source; reviewStatus: ReviewStatus; inflectionCount: number; createdAt: string }` (createdAt as ISO string)
    - `LemmaDetailDTO`: `{ id: number; text: string; translation: string; notes: string | null; partOfSpeech: PartOfSpeech | null; category: string | null; difficultyLevel: DifficultyLevel | null; source: Source; reviewStatus: ReviewStatus; inflections: InflectionDTO[]; createdAt: string; updatedAt: string }`
    - `CreateLemmaRequest`: `{ wordForm: string; translation: string; notes?: string }`
    - `UpdateLemmaRequest`: `{ text: string; translation: string; notes?: string; inflections?: InflectionUpdate[] }`
    - `InflectionUpdate`: `{ id?: number; form: string; grammaticalInfo?: string }`
    - `PaginatedResponse<T>`: `{ content: T[]; totalElements: number; totalPages: number; number: number; size: number; first: boolean; last: boolean }`

    **Part C: API client and Query client**

    Create `frontend/src/lib/api.ts`:
    - Create axios instance with baseURL from `import.meta.env.VITE_API_BASE_URL` (fallback '/api')
    - Export the instance as default

    Create `frontend/src/lib/queryClient.ts`:
    - Create QueryClient with defaultOptions: staleTime 5 minutes, retry 1, refetchOnWindowFocus false
    - Export the queryClient instance

    **Part D: Layout components**

    Create `frontend/src/components/layout/Header.tsx`:
    - App title "Bulgarian Vocabulary" in bold
    - Mobile-responsive: `flex flex-col md:flex-row md:items-center md:justify-between`
    - Sticky header with white background and shadow: `sticky top-0 z-10 bg-white shadow`

    Create `frontend/src/components/layout/Layout.tsx`:
    - Wraps children with Header at top and main content area below
    - Main content: `<main className="container mx-auto px-4 py-6">{children}</main>`

    **Part E: AudioPlayer shared component**

    Create `frontend/src/components/audio/AudioPlayer.tsx`:
    - Props: `audioUrl: string`, optional `label?: string`, optional `size?: 'sm' | 'md'`
    - Uses `useRef<HTMLAudioElement>` for playback control
    - Play/pause button with loading state
    - `onPlay`, `onPause`, `onEnded`, `onError` event handlers
    - `preload="metadata"` for minimal initial load
    - Tailwind styling: inline-flex button with hover state
    - `lang="bg"` on label text
    - Use SVG icons or simple Unicode symbols for play/pause (not emoji)

    **Part F: Wire up main.tsx and App.tsx**

    Update `frontend/src/main.tsx`:
    - Import QueryClientProvider from @tanstack/react-query
    - Import ReactQueryDevtools from @tanstack/react-query-devtools
    - Import queryClient from @/lib/queryClient
    - Wrap App in StrictMode > QueryClientProvider > App + ReactQueryDevtools

    Update `frontend/src/App.tsx`:
    - Import Layout
    - Render Layout wrapping a placeholder: `<h2>Vocabulary list will go here</h2>`
    - This placeholder will be replaced by Plan 02's VocabularyList component
  </action>
  <verify>
    cd /Users/kevin/projects/bulgarian-vocabulary/frontend && npx tsc --noEmit 2>&1 | tail -10
    # TypeScript compilation should pass with no errors

    cd /Users/kevin/projects/bulgarian-vocabulary/backend && mvn compile -q 2>&1 | tail -5
    # Backend should compile with the new audio endpoint
  </verify>
  <done>
    Backend has POST /api/audio/generate endpoint returning filename for given Bulgarian text. Frontend has complete TypeScript types matching all backend DTOs and enums. Axios API client configured with base URL. TanStack Query client with 5-min stale time wraps the app. Layout shell renders with Header (sticky, responsive) and main content area. AudioPlayer component provides play/pause for any audio URL. `npm run build` and `npx tsc --noEmit` pass with no errors.
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run build` succeeds with no errors
2. `cd frontend && npx tsc --noEmit` succeeds with no type errors
3. `cd backend && mvn compile -q` succeeds with audio endpoint changes
4. frontend/package.json contains: react, @tanstack/react-query, zustand, react-hook-form, zod, @hookform/resolvers, axios, tailwindcss
5. frontend/vite.config.ts contains proxy configuration for /api -> localhost:8080
6. frontend/index.html contains lang="bg" and Sofia Sans font link
7. frontend/src/features/vocabulary/types.ts contains LemmaResponseDTO and LemmaDetailDTO
8. frontend/src/components/audio/AudioPlayer.tsx contains useRef and audio element
9. backend AudioController has POST /api/audio/generate endpoint
</verification>

<success_criteria>
- React 19 + Vite 6 + TypeScript project builds and runs with HMR
- All dependencies installed (TanStack Query, Zustand, React Hook Form, Zod, Tailwind, Axios)
- API proxy routes /api to Spring Boot on localhost:8080
- TypeScript types match backend DTOs exactly
- Layout shell renders with responsive header
- AudioPlayer component provides play/pause functionality
- Backend audio generation endpoint available for frontend use
</success_criteria>

<output>
After completion, create `.planning/phases/05-frontend-foundation-vocabulary-ui/05-01-SUMMARY.md`
</output>
